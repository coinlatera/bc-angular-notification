(function(){angular.module("bc.angular-notification",["bc.notifications","bc.notifications-builder","bc.notifications-ui","bc.active-notification","bc.sticky-notification"])}).call(this),function(){angular.module("bc.active-notification",[]).directive("activeNotification",["Notifications","NotificationsUI","$timeout","$rootScope","$sce",function(a,b,c,d,e){return{restrict:"E",template:'<div ng-show="showNotification" class="urgent-notification active" ng-class="className"><span ng-bind-html="message"></span><div class="close"><i class="icon-remove-circle icon-large"></i></div></div>',link:function(f,g){var h,i,j,k,l;return f.showNotification=!1,j=!1,k=function(a){var b;return f.watchedCopy=a,f.$watch("watchedCopy",function(a){return a.general.read?i(a.general.id,!0,l):void 0},!0),j?void 0:(f.notification=angular.copy(a),f.message=e.trustAsHtml(a.content.message),f.className=h(a.display.type),""!==a.display.customClass&&(f.className+=" "+a.display.customClass),f.$$phase||f.$apply(),f.showNotification=!0,b=$(g[0]).find(".urgent-notification"),b.css({display:"block",top:-100}),b.animate({top:68},"slow",function(){var b,d;return d=null!=a.display.duration?a.display.duration:2e3+80*a.content.message.length,-1!==d?c(function(){return i(a.general.id,!0,l)},d):(b=function(){return $("body").unbind("click",b),i(a.general.id,!0,l)},$("body").bind("click",b))}))},i=function(b,c,d){return j||null==f.notification||f.notification.general.id!==b?void 0:(j=!0,c&&(a.markAsRead(f.notification),f.notification.general.read=!0),delete f.notification,$(g[0]).find(".urgent-notification").fadeOut("slow",d))},$(g[0]).find(".close").bind("click",function(){return i(f.notification.general.id,!0,l)}),h=function(a){return"error"===a?"orange":"info"===a?"blue":"success"===a?"green":""},l=function(){var a,b,c,d,e;if(j=!1,null==f.notification){for(d=f.allNotifications,e=[],b=0,c=d.length;c>b;b++)if(a=d[b],a.general.read||f.state.paused&&!a.display.urgent)e.push(void 0);else if("active"===a.display.mode){if(null==f.notification||f.notification.general.read){k(a);break}e.push(void 0)}else e.push(void 0);return e}},f.$watch("allNotifications",function(a,b){return a===b||j?void 0:l()},!0),f.state=b.state(),f.$watch("state",function(a,b){if(null!=a&&null!=a.paused&&(null==b||null==b.paused||a.paused!==b.paused)){if(f.state.paused&&null!=f.notification&&!f.notification.display.urgent&&!j)return i(f.notification.general.id,!1,l);if(!j)return l()}},!0),f.allNotifications=a.all(),d.$watch("notifications",function(){return f.allNotifications=a.all()},!0),l()}}}])}.call(this),function(){angular.module("bc.sticky-notification",[]).directive("stickyNotification",["Notifications","$sce",function(a,b){return{restrict:"E",template:'<div ng-show="showNotification" class="urgent-notification sticky" ng-class="className"><span ng-bind-html-unsafe="title"></span><div class="close"><i class="icon-remove-circle icon-large"></i></div></div>',link:function(c,d){var e,f,g;return c.showNotification=!1,f=function(a){return $(d[0]).find(".urgent-notification").slideUp("slow","linear",function(){return c.notification=a,c.title=b.trustAsHtml(a.title),c.className=e(a.type),null!=a.customClass&&(c.className+=" "+a.customClass),c.$$phase||c.$apply(),c.$watch("notification",function(a){return a.read?$(d[0]).find(".urgent-notification").slideUp("slow","linear",g):void 0},!0),$(d[0]).find(".urgent-notification").slideDown("slow","linear")})},$(d[0]).find(".close").bind("click",function(){return a.markAsRead(c.notification),$(d[0]).find(".urgent-notification").slideUp("slow","linear",g)}),e=function(a){return"error"===a||"urgent"===a?"orange":"pending"===a||"info"===a?"blue":"success"===a?"green":"blue"},g=function(){var a,b,d,e,g;for(e=c.allNotifications,g=[],b=0,d=e.length;d>b;b++)if(a=e[b],a.read)g.push(void 0);else if("sticky"===a.display&&"urgent"===a.type){if(null!=c.notification&&a.id===c.notification.id)continue;g.push(f(a))}else g.push(void 0);return g},c.$watch("allNotifications",function(a,b){return a!==b?g():void 0},!0),c.allNotifications=a.all(),g()}}}])}.call(this),function(){angular.module("bc.notifications",[]).service("Notifications",["$rootScope",function(a){return a.notifications=[],this.all=function(){return a.notifications},this.unread=function(){var b,c,d,e,f;for(c=[],f=a.notifications,d=0,e=f.length;e>d;d++)b=f[d],b.general.read||c.push(b);return c},this.read=function(){var b,c,d,e,f;for(c=[],f=a.notifications,d=0,e=f.length;e>d;d++)b=f[d],b.general.read&&c.push(b);return c},this.markAllAsRead=function(){var b,c,d,e;for(e=a.notifications,c=0,d=e.length;d>c;c++)b=e[c],b.read=!0},this.markAsRead=function(b){var c,d,e,f,g;for(f=a.notifications,g=[],d=0,e=f.length;e>d;d++)c=f[d],c.general.id===b.general.id?g.push(c.general.read=!0):g.push(void 0);return g},this.remove=function(){var b,c;for(b=0,c=[];b<a.notifications.length;)a.notifications[b].general.id===notification.general.id&&a.notifications.splice(b,1),c.push(b++);return c},this.removeAll=function(){return a.notifications=[]},this.show=function(b){a.notifications.push(b)},this}])}.call(this),function(){angular.module("bc.notifications-builder",["bc.angular-i18n"]).service("NotificationsBuilder",["$filter",function(a){var b;return b=function(a,b){return a=a.replace(/\[blue\]([^\[]*)\[\/blue\]/,'<span class="notif-blue">$1</span>'),a=a.replace(/\[green\]([^\[]*)\[\/green\]/,'<span class="notif-green">$1</span>'),a=a.replace(/\[red\]([^\[]*)\[\/red\]/,'<span class="notif-red">$1</span>'),a=a.replace(/\[link\]([^\[]*)\[\/link\]/,'<a class="notif-link">$1</a>'),a=a.replace(/\[button\]([^\[]*)\[\/button\]/,'<a class="btn btn-primary notif-button">$1</a>'),a=a.replace(/[^\\]_([a-zA-Z0-9\$]+)_/g,function(a,c){return a[0]+b[c]}),a=a.replace(/^_([a-zA-Z0-9\$]+)_/g,function(a,c){return b[c]}),a=a.replace(/\\_/g,function(){return"_"}),a=a.replace(/\[link url=([^\]]*)\]([^\[]*)\[\/link\]/,'<a class="notif-link" href="$1">$2</a>'),a=a.replace(/\[button url=([^\]]*)\]([^\[]*)\[\/button\]/,'<a class="btn btn-primary notif-button" href="$1">$2</a>')},this.buildNotification=function(c){return c=$.extend(!0,this.defaults(),c),c.content.message=b(a("translate")(c.content.message,!0),c.content.params),c.content.details=b(a("translate")(c.content.details,!0),c.content.params),c},this.defaults=function(){var a;return a=Math.floor(999999*Math.random()),{general:{id:a,date:(new Date).getTime(),read:!1},content:{message:"",details:"",params:{id:a}},display:{mode:"silent",location:"",urgent:!1,type:"success",dropdown:!1,duration:null,customClass:""}}},this}])}.call(this),function(){angular.module("bc.notifications-ui",[]).service("NotificationsUI",["$rootScope",function(a){return a.state={paused:!1},this.pause=function(){return a.state.paused=!0},this.resume=function(){return a.state.paused=!1},this.state=function(){return a.state},this}])}.call(this);